---
title: "Proyecto final"
output:
  html_document:
    df_print: paged
---

```{r setup, echo=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Introduccion

```{r intro, echo=FALSE, results='asis'}
source("carga_textos.R")
cat(intro_texto)
```


```{r, echo=FALSE}
source("carga_datos.R", encoding = "UTF-8")
```

Relación entre consumo y producción de energía eléctrica, para el período comprendido entre el 1/1/2004 y el 31/12/2018. Mensual y anual. En rojo el consumo, en azul, la producción. Ambos en GWh. ////ESTO LO PODEMOS AGREGAR A LA APP CON UNA VENTANA DESPLEGABLE QUE PERMITA CAMBIAR SI LOS DATOS ESTAN AGRUPADOS POR MES O POR AÑO

```{r, echo=FALSE}
 consumoEE.datos2 %>% select(Fecha, Demanda, `Producción Total`, Fuente) %>%
           filter(Fecha<="2018-12-31") %>% 
           gather(key="Clase", value="Energía", Demanda, `Producción Total`) %>%
           group_by(month = floor_date(Fecha, "month"), Clase) %>%
           summarize(`EnergíaTotal` = sum(`Energía`)) %>% 
           ggplot(aes(x=month, y=`EnergíaTotal`, color = Clase)) + 
           geom_point() + geom_smooth(method="lm", se = FALSE) +
           labs(x = "Fecha", y = "Energía (GWh)") + 
           theme(aspect.ratio = 1)

```

```{r, echo=FALSE}
 consumoEE.datos2 %>%
   group_by(Estacion = floor_date(Fecha, "season"))%>%
   summarise(Demanda = sum(Demanda))%>%
   filter(Estacion < "2019-06-01", Estacion > "2003-12-01"	 )%>%
   ggplot(aes(x = Estacion, y = Demanda))+
   geom_line() +
   theme(aspect.ratio = 1/3)+
   stat_peaks(colour = "blue", geom = "text",vjust = -0.5, angle = -45)+
   labs(x = "Fecha en trimestres", y = "Demanda de energia", title = "¿Como se comporta la demanda de energia al dividirla por estacion?")
```
