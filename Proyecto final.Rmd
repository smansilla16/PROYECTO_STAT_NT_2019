---
title: "Proyecto final"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduccion

(..Problema..) Nuestra pregunta principal sería ¿el consumo de electricidad nacional depende del clima? Para responderla obtuvimos registros del clima y del consumo energético nacional y los asociamos por fecha.

Relaciones entre variables:

produccion = Hidráulica + Térmica + Eólica + Biomasa + Fotovoltaica + exportaciones + consumos

exportaciones = Exportación + Exp. Otros Agentes + Exp. Salto Grande

consumos = Cons. de Generación

Demanda = producción + Importación - exportaciones - consumos



```{r}
library(readxl)
library(forcats)
library(ggplot2)
library(tidyverse)
library(lubridate)

# clima por fecha
clima <- read_xlsx("clima.xlsx")

# consumo por fecha
consumoen <- read_xlsx('consumoenergiaelectrica.xlsx')

# para asociar las tablas por fecha convertimos a tipo fecha
# las variables correspondientes, en la tabla de clima el formato
# de la variable fecha es una cadena de caracteres en la forma YYYYmmdd,
# en la tabla de consumo energético el formato de la variable fecha
# es representado en formato POSIXct, utilizamos la función ymd()
# de lubridate para la conversión a un formato común

# simplificación de la tabla de clima según las variables que nos interesan
# y conversión de temperatura de °F a °C
clima.simple <- clima %>%
                mutate(Fecha = ymd(YEARMODA),
                       TEMP = (as.numeric(TEMP)-32)*5/9) %>%
                rename(temp_c = TEMP) %>%
                select(c(Fecha, temp_c))

# primera simplificación de la tabla de consumo energético según
# las variables que nos interesan y asociación con la tabla de clima
consumoen.simple <- consumoen %>%
                    mutate(Fecha = ymd(Fecha)) %>%
                    left_join(clima.simple, by = "Fecha")

# segunda simplificación de la tabla de consumo energético según
# las variables que nos interesan
consumoen.simple2 <- consumoen.simple %>%
                     gather(fuente, produccion,`Hidráulica`, `Térmica`, `Eólica`, Biomasa, Fotovoltaica)

colnames(consumoen.simple2)

```